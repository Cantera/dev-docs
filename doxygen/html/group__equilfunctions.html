<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Cantera: Equilfunctions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cantera
   &#160;<span id="projectnumber">2.3.0a1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Equilfunctions</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCantera_1_1MultiPhase.html">MultiPhase</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for multiphase mixtures.  <a href="classCantera_1_1MultiPhase.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCantera_1_1vcs__MultiPhaseEquil.html">vcs_MultiPhaseEquil</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cantera's <a class="el" href="classCantera_1_1Interface.html" title="An interface between multiple bulk phases. ">Interface</a> to the Multiphase chemical equilibrium solver.  <a href="classCantera_1_1vcs__MultiPhaseEquil.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf658f6d2afb439d254b43166f270861e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#gaf658f6d2afb439d254b43166f270861e">equilibrate</a> (const std::string &amp;XY, const std::string &amp;solver=&quot;auto&quot;, double rtol=1e-9, int max_steps=50000, int max_iter=100, int estimate_equil=0, int log_level=0)</td></tr>
<tr class="memdesc:gaf658f6d2afb439d254b43166f270861e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equilibrate a <a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures. ">MultiPhase</a> object.  <a href="#gaf658f6d2afb439d254b43166f270861e">More...</a><br /></td></tr>
<tr class="separator:gaf658f6d2afb439d254b43166f270861e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga736bfa5922a7dc8d12498e37b14652f5"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#ga736bfa5922a7dc8d12498e37b14652f5">BasisOptimize</a> (int *usedZeroedSpecies, bool doFormRxn, MultiPhase *mphase, std::vector&lt; size_t &gt; &amp;orderVectorSpecies, std::vector&lt; size_t &gt; &amp;orderVectorElements, vector_fp &amp;formRxnMatrix)</td></tr>
<tr class="memdesc:ga736bfa5922a7dc8d12498e37b14652f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Choose the optimum basis of species for the equilibrium calculations.  <a href="group__equilfunctions.html#ga736bfa5922a7dc8d12498e37b14652f5">More...</a><br /></td></tr>
<tr class="separator:ga736bfa5922a7dc8d12498e37b14652f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8932a893caf09a6d1aef50d19238d7b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#ga8932a893caf09a6d1aef50d19238d7b0">ElemRearrange</a> (size_t nComponents, const vector_fp &amp;elementAbundances, MultiPhase *mphase, std::vector&lt; size_t &gt; &amp;orderVectorSpecies, std::vector&lt; size_t &gt; &amp;orderVectorElements)</td></tr>
<tr class="memdesc:ga8932a893caf09a6d1aef50d19238d7b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the potential rearrangement of the constraint equations represented by the Formula Matrix.  <a href="group__equilfunctions.html#ga8932a893caf09a6d1aef50d19238d7b0">More...</a><br /></td></tr>
<tr class="separator:ga8932a893caf09a6d1aef50d19238d7b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Chemical Equilibrium</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrpf94928bad645173bf24fc7c5bf0f2971"></a>Chemical equilibrium. </p>
</td></tr>
<tr class="memitem:gaf658f6d2afb439d254b43166f270861e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#gaf658f6d2afb439d254b43166f270861e">equilibrate</a> (const std::string &amp;XY, const std::string &amp;solver=&quot;auto&quot;, double rtol=1e-9, int max_steps=50000, int max_iter=100, int estimate_equil=0, int log_level=0)</td></tr>
<tr class="memdesc:gaf658f6d2afb439d254b43166f270861e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equilibrate a <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties. ">ThermoPhase</a> object.  <a href="#gaf658f6d2afb439d254b43166f270861e">More...</a><br /></td></tr>
<tr class="separator:gaf658f6d2afb439d254b43166f270861e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabff9a8a035d3a59f00458ff8fca4f8c9"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#gabff9a8a035d3a59f00458ff8fca4f8c9">setToEquilState</a> (const doublereal *lambda_RT)</td></tr>
<tr class="memdesc:gabff9a8a035d3a59f00458ff8fca4f8c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is used by the <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions. ">ChemEquil</a> equilibrium solver.  <a href="#gabff9a8a035d3a59f00458ff8fca4f8c9">More...</a><br /></td></tr>
<tr class="separator:gabff9a8a035d3a59f00458ff8fca4f8c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf49509a8378cb3502af4daf5ab7c66d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#gaf49509a8378cb3502af4daf5ab7c66d7">setElementPotentials</a> (const vector_fp &amp;lambda)</td></tr>
<tr class="memdesc:gaf49509a8378cb3502af4daf5ab7c66d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the element potentials in the <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties. ">ThermoPhase</a> object.  <a href="#gaf49509a8378cb3502af4daf5ab7c66d7">More...</a><br /></td></tr>
<tr class="separator:gaf49509a8378cb3502af4daf5ab7c66d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaed975464edf5ab3586f73bb71dd9078"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__equilfunctions.html#gaaed975464edf5ab3586f73bb71dd9078">getElementPotentials</a> (doublereal *lambda) const </td></tr>
<tr class="memdesc:gaaed975464edf5ab3586f73bb71dd9078"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the element potentials stored in the <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties. ">ThermoPhase</a> object.  <a href="#gaaed975464edf5ab3586f73bb71dd9078">More...</a><br /></td></tr>
<tr class="separator:gaaed975464edf5ab3586f73bb71dd9078"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaf658f6d2afb439d254b43166f270861e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void equilibrate </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>XY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>solver</em> = <code>&quot;auto&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rtol</em> = <code>1e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_steps</em> = <code>50000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>estimate_equil</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>log_level</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Equilibrate a <a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures. ">MultiPhase</a> object. </p>
<p>Set this mixture to chemical equilibrium by calling one of <a class="el" href="namespaceCantera.html" title="Namespace for the Cantera kernel. ">Cantera</a>'s equilibrium solvers. The XY parameter indicates what two thermodynamic quantities are to be held constant during the equilibration process.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">XY</td><td>String representation of what two properties are being held constant </td></tr>
    <tr><td class="paramname">solver</td><td>Name of the solver to be used to equilibrate the phase. If solver = 'vcs', the <a class="el" href="classCantera_1_1vcs__MultiPhaseEquil.html" title="Cantera&#39;s Interface to the Multiphase chemical equilibrium solver. ">vcs_MultiPhaseEquil</a> solver will be used. If solver = 'gibbs', the <a class="el" href="classCantera_1_1MultiPhaseEquil.html">MultiPhaseEquil</a> solver will be used. If solver = 'auto', the 'vcs' solver will be tried first, followed by the 'gibbs' solver if the first one fails. </td></tr>
    <tr><td class="paramname">rtol</td><td>Relative tolerance </td></tr>
    <tr><td class="paramname">max_steps</td><td>Maximum number of steps to take to find the solution </td></tr>
    <tr><td class="paramname">max_iter</td><td>The maximum number of outer temperature or pressure iterations to take when T and/or P is not held fixed. </td></tr>
    <tr><td class="paramname">estimate_equil</td><td>integer indicating whether the solver should estimate its own initial condition. If 0, the initial mole fraction vector in the <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties. ">ThermoPhase</a> object is used as the initial condition. If 1, the initial mole fraction vector is used if the element abundances are satisfied. If -1, the initial mole fraction vector is thrown out, and an estimate is formulated. </td></tr>
    <tr><td class="paramname">log_level</td><td>loglevel Controls amount of diagnostic output. log_level=0 suppresses diagnostics, and increasingly-verbose messages are written as loglevel increases. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="MultiPhase_8cpp_source.html#l00716">716</a> of file <a class="el" href="MultiPhase_8cpp_source.html">MultiPhase.cpp</a>.</p>

<p>References <a class="el" href="ChemEquil_8cpp_source.html#l00023">Cantera::_equilflag()</a>, <a class="el" href="global_8h_source.html#l00154">Cantera::debuglog()</a>, <a class="el" href="vcs__MultiPhaseEquil_8cpp_source.html#l00397">vcs_MultiPhaseEquil::equilibrate()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00547">MultiPhase::equilibrate_MultiPhaseEquil()</a>, <a class="el" href="MultiPhase_8h_source.html#l00586">MultiPhase::m_moleFractions</a>, <a class="el" href="MultiPhase_8h_source.html#l00571">MultiPhase::m_moles</a>, <a class="el" href="MultiPhase_8h_source.html#l00624">MultiPhase::m_press</a>, <a class="el" href="MultiPhase_8h_source.html#l00621">MultiPhase::m_temp</a>, and <a class="el" href="MultiPhase_8cpp_source.html#l00902">MultiPhase::updatePhases()</a>.</p>

<p>Referenced by <a class="el" href="ThermoPhase_8cpp_source.html#l00751">ThermoPhase::equilibrate()</a>, and <a class="el" href="MultiPhase_8h_source.html#l00331">MultiPhase::temperature()</a>.</p>

</div>
</div>
<a class="anchor" id="ga736bfa5922a7dc8d12498e37b14652f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t BasisOptimize </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>usedZeroedSpecies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>doFormRxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCantera_1_1MultiPhase.html">MultiPhase</a> *&#160;</td>
          <td class="paramname"><em>mphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>orderVectorSpecies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>orderVectorElements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceCantera.html#a8a71f536c7e45bda27ec0f1df26e6420">vector_fp</a> &amp;&#160;</td>
          <td class="paramname"><em>formRxnMatrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Choose the optimum basis of species for the equilibrium calculations. </p>
<p>This is done by choosing the species with the largest mole fraction not currently a linear combination of the previous components. Then, calculate the stoichiometric coefficient matrix for that basis.</p>
<p>Calculates the identity of the component species in the mechanism. Rearranges the solution data to put the component data at the front of the species list.</p>
<p>Then, calculates SC(J,I) the formation reactions for all noncomponent species in the mechanism.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mphase</td><td>Pointer to the multiphase object. Contains the species mole fractions, which are used to pick the current optimal species component basis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orderVectorElements</td><td>Order vector for the elements. The element rows in the formula matrix are rearranged according to this vector. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orderVectorSpecies</td><td>Order vector for the species. The species are rearranged according to this formula. The first nCompoments of this vector contain the calculated species components on exit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">doFormRxn</td><td>If true, the routine calculates the formation reaction matrix based on the calculated component species. If false, this step is skipped. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">usedZeroedSpecies</td><td>= If true, then a species with a zero concentration was used as a component. The problem may be converged. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">formRxnMatrix</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of components. </dd></dl>

<p>Definition at line <a class="el" href="BasisOptimize_8cpp_source.html#l00026">26</a> of file <a class="el" href="BasisOptimize_8cpp_source.html">BasisOptimize.cpp</a>.</p>

<p>References <a class="el" href="MultiPhase_8cpp_source.html#l00803">MultiPhase::elementName()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00429">MultiPhase::getMoles()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00837">MultiPhase::nAtoms()</a>, <a class="el" href="MultiPhase_8h_source.html#l00100">MultiPhase::nElements()</a>, <a class="el" href="MultiPhase_8h_source.html#l00126">MultiPhase::nSpecies()</a>, <a class="el" href="BasisOptimize_8cpp_source.html#l00335">Cantera::print_stringTrunc()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00832">MultiPhase::speciesName()</a>, <a class="el" href="global_8h_source.html#l00166">Cantera::writelog()</a>, and <a class="el" href="global_8h_source.html#l00186">Cantera::writelogf()</a>.</p>

<p>Referenced by <a class="el" href="ChemEquil_8cpp_source.html#l00224">ChemEquil::estimateElementPotentials()</a>, and <a class="el" href="MultiPhase_8h_source.html#l00671">Cantera::operator&lt;&lt;()</a>.</p>

</div>
</div>
<a class="anchor" id="ga8932a893caf09a6d1aef50d19238d7b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ElemRearrange </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceCantera.html#a8a71f536c7e45bda27ec0f1df26e6420">vector_fp</a> &amp;&#160;</td>
          <td class="paramname"><em>elementAbundances</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCantera_1_1MultiPhase.html">MultiPhase</a> *&#160;</td>
          <td class="paramname"><em>mphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>orderVectorSpecies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>orderVectorElements</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles the potential rearrangement of the constraint equations represented by the Formula Matrix. </p>
<p>Rearrangement is only necessary when the number of components is less than the number of elements. For this case, some constraints can never be satisfied exactly, because the range space represented by the Formula Matrix of the components can't span the extra space. These constraints, which are out of the range space of the component Formula matrix entries, are migrated to the back of the Formula matrix.</p>
<p>A prototypical example is an extra element column in FormulaMatrix[], which is identically zero. For example, let's say that argon is has an element column in FormulaMatrix[], but no species in the mechanism actually contains argon. Then, nc &lt; ne. Unless the entry for desired element abundance vector for Ar is zero, then this element abundance constraint can never be satisfied. The constraint vector is not in the range space of the formula matrix.</p>
<p>Also, without perturbation of FormulaMatrix[], BasisOptimize[] would produce a zero pivot because the matrix would be singular (unless the argon element column was already the last column of FormulaMatrix[].</p>
<p>This routine borrows heavily from BasisOptimize algorithm. It finds nc constraints which span the range space of the Component Formula matrix, and assigns them as the first nc components in the formula matrix. This guarantees that BasisOptimize has a nonsingular matrix to invert.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nComponents</td><td>Number of components calculated previously. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">elementAbundances</td><td>Current value of the element abundances </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mphase</td><td>Input pointer to a <a class="el" href="classCantera_1_1MultiPhase.html" title="A class for multiphase mixtures. ">MultiPhase</a> object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orderVectorSpecies</td><td>input vector containing the ordering of the global species in mphase. This is used to extract the component basis of the mphase object. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">orderVectorElements</td><td>Output vector containing the order of the elements that is necessary for calculation of the formula matrix. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="BasisOptimize_8cpp_source.html#l00366">366</a> of file <a class="el" href="BasisOptimize_8cpp_source.html">BasisOptimize.cpp</a>.</p>

<p>References <a class="el" href="MultiPhase_8cpp_source.html#l00803">MultiPhase::elementName()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00837">MultiPhase::nAtoms()</a>, <a class="el" href="MultiPhase_8h_source.html#l00100">MultiPhase::nElements()</a>, <a class="el" href="MultiPhase_8h_source.html#l00126">MultiPhase::nSpecies()</a>, <a class="el" href="global_8h_source.html#l00166">Cantera::writelog()</a>, and <a class="el" href="global_8h_source.html#l00186">Cantera::writelogf()</a>.</p>

<p>Referenced by <a class="el" href="ChemEquil_8cpp_source.html#l00224">ChemEquil::estimateElementPotentials()</a>, and <a class="el" href="MultiPhase_8h_source.html#l00671">Cantera::operator&lt;&lt;()</a>.</p>

</div>
</div>
<a class="anchor" id="gaf658f6d2afb439d254b43166f270861e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void equilibrate </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>XY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>solver</em> = <code>&quot;auto&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rtol</em> = <code>1e-9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_steps</em> = <code>50000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>estimate_equil</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>log_level</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Equilibrate a <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties. ">ThermoPhase</a> object. </p>
<p>Set this phase to chemical equilibrium by calling one of several equilibrium solvers. The XY parameter indicates what two thermodynamic quantities are to be held constant during the equilibration process.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">XY</td><td>String representation of what two properties are being held constant </td></tr>
    <tr><td class="paramname">solver</td><td>Name of the solver to be used to equilibrate the phase. If solver = 'element_potential', the <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions. ">ChemEquil</a> element potential solver will be used. If solver = 'vcs', the VCS solver will be used. If solver = 'gibbs', the <a class="el" href="classCantera_1_1MultiPhaseEquil.html">MultiPhaseEquil</a> solver will be used. If solver = 'auto', the solvers will be tried in order if the initial solver(s) fail. </td></tr>
    <tr><td class="paramname">rtol</td><td>Relative tolerance </td></tr>
    <tr><td class="paramname">max_steps</td><td>Maximum number of steps to take to find the solution </td></tr>
    <tr><td class="paramname">max_iter</td><td>For the 'gibbs' and 'vcs' solvers, this is the maximum number of outer temperature or pressure iterations to take when T and/or P is not held fixed. </td></tr>
    <tr><td class="paramname">estimate_equil</td><td>integer indicating whether the solver should estimate its own initial condition. If 0, the initial mole fraction vector in the <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties. ">ThermoPhase</a> object is used as the initial condition. If 1, the initial mole fraction vector is used if the element abundances are satisfied. If -1, the initial mole fraction vector is thrown out, and an estimate is formulated. </td></tr>
    <tr><td class="paramname">log_level</td><td>loglevel Controls amount of diagnostic output. log_level=0 suppresses diagnostics, and increasingly-verbose messages are written as loglevel increases. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ThermoPhase_8cpp_source.html#l00751">751</a> of file <a class="el" href="ThermoPhase_8cpp_source.html">ThermoPhase.cpp</a>.</p>

<p>References <a class="el" href="MultiPhase_8cpp_source.html#l00088">MultiPhase::addPhase()</a>, <a class="el" href="global_8h_source.html#l00154">Cantera::debuglog()</a>, <a class="el" href="ChemEquil_8cpp_source.html#l00316">ChemEquil::equilibrate()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00716">MultiPhase::equilibrate()</a>, <a class="el" href="MultiPhase_8cpp_source.html#l00152">MultiPhase::init()</a>, <a class="el" href="ChemEquil_8h_source.html#l00035">EquilOpt::maxIterations</a>, <a class="el" href="ChemEquil_8h_source.html#l00140">ChemEquil::options</a>, <a class="el" href="ChemEquil_8h_source.html#l00033">EquilOpt::relTolerance</a>, <a class="el" href="Phase_8cpp_source.html#l00307">Phase::restoreState()</a>, <a class="el" href="Phase_8cpp_source.html#l00295">Phase::saveState()</a>, and <a class="el" href="ThermoPhase_8cpp_source.html#l00798">ThermoPhase::setElementPotentials()</a>.</p>

<p>Referenced by <a class="el" href="ThermoPhase_8h_source.html#l01102">ThermoPhase::setState_RP()</a>.</p>

</div>
</div>
<a class="anchor" id="gabff9a8a035d3a59f00458ff8fca4f8c9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void setToEquilState </td>
          <td>(</td>
          <td class="paramtype">const doublereal *&#160;</td>
          <td class="paramname"><em>lambda_RT</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method is used by the <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions. ">ChemEquil</a> equilibrium solver. </p>
<p>It sets the state such that the chemical potentials satisfy </p><p class="formulaDsp">
\[ \frac{\mu_k}{\hat R T} = \sum_m A_{k,m} \left(\frac{\lambda_m} {\hat R T}\right) \]
</p>
<p> where \( \lambda_m \) is the element potential of element m. The temperature is unchanged. Any phase (ideal or not) that implements this method can be equilibrated by <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions. ">ChemEquil</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lambda_RT</td><td>Input vector of dimensionless element potentials The length is equal to <a class="el" href="classCantera_1_1Phase.html#a1095b1a9ec785dbb5014b9b9684dfd83" title="Number of elements. ">nElements()</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classCantera_1_1IdealSolidSolnPhase.html#a02da43a545df400427d067e2b07b8a08">IdealSolidSolnPhase</a>, <a class="el" href="classCantera_1_1IdealGasPhase.html#a02da43a545df400427d067e2b07b8a08">IdealGasPhase</a>, <a class="el" href="classCantera_1_1RedlichKwongMFTP.html#a02da43a545df400427d067e2b07b8a08">RedlichKwongMFTP</a>, and <a class="el" href="classCantera_1_1IdealSolnGasVPSS.html#a02da43a545df400427d067e2b07b8a08">IdealSolnGasVPSS</a>.</p>

<p>Definition at line <a class="el" href="ThermoPhase_8h_source.html#l01271">1271</a> of file <a class="el" href="ThermoPhase_8h_source.html">ThermoPhase.h</a>.</p>

<p>References <a class="el" href="ThermoPhase_8cpp_source.html#l00811">ThermoPhase::getElementPotentials()</a>, and <a class="el" href="ThermoPhase_8cpp_source.html#l00798">ThermoPhase::setElementPotentials()</a>.</p>

<p>Referenced by <a class="el" href="ChemEquil_8cpp_source.html#l00138">ChemEquil::setToEquilState()</a>.</p>

</div>
</div>
<a class="anchor" id="gaf49509a8378cb3502af4daf5ab7c66d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setElementPotentials </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceCantera.html#a8a71f536c7e45bda27ec0f1df26e6420">vector_fp</a> &amp;&#160;</td>
          <td class="paramname"><em>lambda</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores the element potentials in the <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties. ">ThermoPhase</a> object. </p>
<p>Called by the <a class="el" href="classCantera_1_1ChemEquil.html" title="Class ChemEquil implements a chemical equilibrium solver for single-phase solutions. ">ChemEquil</a> equilibrium solver to transfer the element potentials to this object after every successful equilibration routine. The element potentials are stored in their dimensionless forms, calculated by dividing by RT.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lambda</td><td>Input vector containing the element potentials. Length = nElements. Units are Joules/kmol. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ThermoPhase_8cpp_source.html#l00798">798</a> of file <a class="el" href="ThermoPhase_8cpp_source.html">ThermoPhase.cpp</a>.</p>

<p>References <a class="el" href="ThermoPhase_8h_source.html#l01688">ThermoPhase::m_hasElementPotentials</a>, <a class="el" href="ThermoPhase_8h_source.html#l01684">ThermoPhase::m_lambdaRRT</a>, <a class="el" href="Phase_8cpp_source.html#l00160">Phase::nElements()</a>, <a class="el" href="ThermoPhase_8h_source.html#l00791">ThermoPhase::RT()</a>, and <a class="el" href="utilities_8h_source.html#l00128">Cantera::scale()</a>.</p>

<p>Referenced by <a class="el" href="ChemEquil_8cpp_source.html#l00328">ChemEquil::equilibrate()</a>, <a class="el" href="ThermoPhase_8cpp_source.html#l00751">ThermoPhase::equilibrate()</a>, and <a class="el" href="ThermoPhase_8h_source.html#l01271">ThermoPhase::setToEquilState()</a>.</p>

</div>
</div>
<a class="anchor" id="gaaed975464edf5ab3586f73bb71dd9078"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool getElementPotentials </td>
          <td>(</td>
          <td class="paramtype">doublereal *&#160;</td>
          <td class="paramname"><em>lambda</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the element potentials stored in the <a class="el" href="classCantera_1_1ThermoPhase.html" title="Base class for a phase with thermodynamic properties. ">ThermoPhase</a> object. </p>
<p>Returns the stored element potentials. The element potentials are retrieved from their stored dimensionless forms by multiplying by RT. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lambda</td><td>Output vector containing the element potentials. Length = nElements. Units are Joules/kmol. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool indicating whether there are any valid stored element potentials. The calling routine should check this bool. In the case that there aren't any, lambda is not touched. </dd></dl>

<p>Definition at line <a class="el" href="ThermoPhase_8cpp_source.html#l00811">811</a> of file <a class="el" href="ThermoPhase_8cpp_source.html">ThermoPhase.cpp</a>.</p>

<p>References <a class="el" href="ThermoPhase_8h_source.html#l01688">ThermoPhase::m_hasElementPotentials</a>, <a class="el" href="ThermoPhase_8h_source.html#l01684">ThermoPhase::m_lambdaRRT</a>, <a class="el" href="ThermoPhase_8h_source.html#l00791">ThermoPhase::RT()</a>, and <a class="el" href="utilities_8h_source.html#l00128">Cantera::scale()</a>.</p>

<p>Referenced by <a class="el" href="ChemEquil_8cpp_source.html#l00328">ChemEquil::equilibrate()</a>, and <a class="el" href="ThermoPhase_8h_source.html#l01271">ThermoPhase::setToEquilState()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
